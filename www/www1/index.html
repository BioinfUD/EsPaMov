<!DOCTYPE html>
<html>
  <script src="http://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.4/jquery.min.js"/></script>
  <script src="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>
  <link rel="stylesheet" href="http://netdna.bootstrapcdn.com/bootswatch/3.3.5/united/bootstrap.min.css"/>
  <script src="http://cdnjs.cloudflare.com/ajax/libs/d3/3.5.6/d3.min.js"></script>
  <script src="escher.js" charset="utf-8"></script>
  <link rel="stylesheet" href="builder.css"/>
  <link rel="stylesheet" type="text/css" href="../css/fa/css/font-awesome.min.css" />
  <link href="../css/material.min.css" rel="stylesheet"/>
  <link href="../css/material-select.min.css" rel="stylesheet"/>
  <script src="../js/jquery-1.11.3.min.js"></script>
  <script src="../js/material.min.js"></script>
  <link href="../css/dialog.css" rel="stylesheet"/>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, height=device-height,initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui"/>
  <body>
    <div id="map_container"></div>
    <dialog id="error" class="mdl-dialog">
      <h3 id="error_title" class="mdl-dialog__title">Message</h3>
      <div class="mdl-dialog__content">
        <p id="error_text">
          The graph may take a long time to load.
        </p>
      </div>
      <div class="mdl-dialog__actions">
        <button id="close_error" type="button" class="mdl-button">Close</button>
      </div>
    </dialog>
    <script src="../js/dialog.js"></script>
    <script type="text/javascript">
    var dialog = document.querySelector('dialog');
    dialogPolyfill.registerDialog(dialog);
    dialog.showModal();
    console.log('showModal()');
    $('#close_error').on('click',function(){
      dialog.close();
    });
    </script>
    <script>
     // load the map and embedded CSS
     alert('1');
     var urlParams = new URLSearchParams(window.location.search);
     if(urlParams.has('url')){
       var url = urlParams.get('url');
     }else{
       var url = 'http://cdn.rcsb.org/pathway/Escherichia coli/e_coli_core.Core metabolism/e_coli_core.Core metabolism.json';
     }
     alert(urlParams.has('url'));
     aler(urlParams.get('url'));
     d3.json(url, function(e, data) {
         if (e) console.warn(e);
         var options = {
             menu: 'zoom',
             use_3d_transform: true,
             enable_editing: false,
             fill_screen: true,
             reaction_styles: ['abs', 'color', 'size', 'text'],
             never_ask_before_quit: true,
             //make the primary metabolites larger to make room for structues
             primary_metabolite_radius: 70,
             first_load_callback: function(){

             }
         };
         // make a Builder
         var builder = escher.Builder(data, null, null, d3.select('#map_container'), options);
         // add the structures
         //add_structures();
     });
    </script>
  </body>
</html>
