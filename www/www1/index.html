<!DOCTYPE html>
<html>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.4/jquery.min.js"/></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>
  <link rel="stylesheet" href="https://netdna.bootstrapcdn.com/bootswatch/3.3.5/united/bootstrap.min.css"/>
  <script src="d3.min.js" charset="utf-8"></script>
  <script src="escher.js" charset="utf-8"></script>
  <link rel="stylesheet" href="builder.css"/>
  <link rel="stylesheet" type="text/css" href="../css/index.css" />
  <link rel="stylesheet" type="text/css" href="../css/fa/css/font-awesome.min.css" />
  <link href="../css/material.min.css" rel="stylesheet"/>
  <link href="../css/material-select.min.css" rel="stylesheet"/>
  <script src="../js/jquery-1.11.3.min.js"></script>
  <script src="../js/material.min.js"></script>
  <link href="../css/dialog.css" rel="stylesheet"/>
  <meta content="utf-8" http-equiv="encoding">
  <meta http-equiv="Content-Security-Policy" content="default-src *; style-src * 'unsafe-inline'; script-src * 'unsafe-inline' 'unsafe-eval'; img-src * data: 'unsafe-inline'; connect-src * 'unsafe-inline'; frame-src *;">
  <meta name="viewport" content="width=device-width, height=device-height,initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui"/>
  <body>
    <div id="map_container"></div>
    <dialog id="error" class="mdl-dialog">
      <h3 id="error_title" class="mdl-dialog__title">Message</h3>
      <div class="mdl-dialog__content">
        <p id="error_text">
        </p>
      </div>
      <div class="mdl-dialog__actions">
        <button id="close_error" type="button" class="mdl-button">Close</button>
      </div>
    </dialog>
    <script src="../js/dialog.js"></script>
    <script type="text/javascript" src="../cordova.js"></script>
    <script src="../js/dialog.js"></script>
    <script src="../js/index.js"></script>
    <!-- <script type="text/javascript" src="cordova.js"></script> -->
    <script>
    document.addEventListener('deviceready', init_graph, false);
    function init_graph() {
        show_error('The graph may take a long time to render.');
        var urlParams = new URLSearchParams(window.location.search);
        if(urlParams.has('url')){
          var url = urlParams.get('url');
        }else{
          var url = 'https://cdn.rcsb.org/pathway/Escherichia coli/e_coli_core.Core metabolism/e_coli_core.Core metabolism.json';
        }
        try {
          d3.json(url, function(e, data) {
              if (e) alert(e);
              var options = {
                  menu: 'zoom',
                  use_3d_transform: true,
                  enable_editing: false,
                  fill_screen: true,
                  reaction_styles: ['abs', 'color', 'size', 'text'],
                  never_ask_before_quit: true,
                  //make the primary metabolites larger to make room for structues
                  primary_metabolite_radius: 70
              };
              var select = d3.select('#map_container');
              // make a Builder
              var builder = escher.Builder(data, null, null, select, options);
              // add the structures
              //add_structures();
          });
        } catch (e) {
          alert(e.message);
        }
    }
    $(function(){
      init_graph();
    });
    </script>
  </body>
</html>
